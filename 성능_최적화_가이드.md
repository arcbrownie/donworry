# 성능 최적화 가이드

## 적용된 최적화 사항

### 1. Vite 빌드 최적화 ✅
- **코드 스플리팅**: 라이브러리를 청크로 분리하여 초기 로딩 시간 단축
  - React 관련: `react-vendor`
  - UI 라이브러리: `ui-vendor`
  - 차트: `chart-vendor`
  - 폼: `form-vendor`
- **Minify**: Terser를 사용한 코드 압축
- **콘솔 로그 제거**: 프로덕션 빌드에서 console.log 제거

### 2. 폰트 최적화 ✅
- **Preload**: 폰트를 미리 로드하여 FCP 개선
- **비동기 로딩**: CSS를 비동기로 로드하여 렌더링 차단 방지
- **CSS에서 폰트 import 제거**: index.html에서 직접 로드

### 3. 스크립트 최적화 ✅
- **GTM defer**: Google Tag Manager 스크립트를 defer로 변경
- **AdSense defer**: Google AdSense 스크립트를 defer로 변경
- **렌더링 차단 방지**: 스크립트가 페이지 렌더링을 차단하지 않도록 설정

### 4. 리소스 힌트 추가 ✅
- **DNS Prefetch**: 외부 도메인에 대한 DNS 조회 사전 수행
- **Preconnect**: 중요한 외부 리소스에 대한 연결 사전 설정

## 추가 최적화 권장 사항

### 1. OG 이미지 최적화 (중요)
현재 `og-image.png` 파일을 최적화하세요:

**방법 1: 온라인 도구 사용**
- TinyPNG: https://tinypng.com/
- Squoosh: https://squoosh.app/
- 목표: 200KB 이하

**방법 2: WebP 변환**
```bash
# WebP로 변환 (더 작은 용량)
# 온라인 도구: https://cloudconvert.com/png-to-webp
```

**방법 3: 이미지 압축**
- PNG → 최적화된 PNG (압축률 70-80%)
- 또는 PNG → WebP (용량 50-70% 감소)

### 2. Terser 플러그인 설치 (선택)
더 나은 압축을 위해 terser를 설치할 수 있습니다:

```bash
npm install --save-dev terser
```

### 3. 이미지 Lazy Loading
이미지가 많은 페이지에 lazy loading 적용:

```tsx
<img src="..." loading="lazy" alt="..." />
```

### 4. 코드 스플리팅 추가
라우트별 코드 스플리팅:

```tsx
// App.tsx에서
const CalculatorHub = lazy(() => import('./pages/cal/CalculatorHub'));
```

### 5. 서비스 워커 (PWA)
오프라인 지원 및 캐싱:

```bash
npm install --save-dev vite-plugin-pwa
```

## 성능 측정

### 목표 지표
- **FCP (First Contentful Paint)**: < 1.8초
- **LCP (Largest Contentful Paint)**: < 2.5초
- **TBT (Total Blocking Time)**: < 200ms
- **CLS (Cumulative Layout Shift)**: < 0.1
- **Speed Index**: < 3.4초

### 측정 도구
1. **Google PageSpeed Insights**: https://pagespeed.web.dev/
2. **Lighthouse (Chrome DevTools)**: F12 → Lighthouse 탭
3. **WebPageTest**: https://www.webpagetest.org/

## 배포 후 확인 사항

1. **빌드 테스트**
   ```bash
   npm run build
   npm run preview
   ```

2. **청크 크기 확인**
   - `dist/` 폴더에서 파일 크기 확인
   - 각 청크가 200KB 이하인지 확인

3. **실제 성능 테스트**
   - PageSpeed Insights로 재측정
   - 목표: 80점 이상

## 문제 해결

### 빌드 오류 발생 시
```bash
# Terser가 없으면 esbuild로 fallback
# vite.config.ts에서 minify: 'esbuild'로 변경
```

### 폰트가 깨질 때
- `index.html`의 폰트 preload 확인
- `src/index.css`에서 폰트 import 제거 확인

### 스크립트가 작동하지 않을 때
- GTM/AdSense defer 설정 확인
- 브라우저 콘솔에서 오류 확인

## 예상 개선 효과

- **FCP**: 4.8s → 2.0s 이하 (약 60% 개선)
- **LCP**: 6.3s → 2.5s 이하 (약 60% 개선)
- **Speed Index**: 6.1s → 3.5s 이하 (약 43% 개선)
- **성능 점수**: 63점 → 80점 이상 (목표)

## 추가 리소스

- [Web.dev Performance](https://web.dev/performance/)
- [Vite Performance Guide](https://vitejs.dev/guide/performance.html)
- [Core Web Vitals](https://web.dev/vitals/)
